// --- Dynamic Lesson Viewer for FutureFunds ---
// Supports multiple courses and dynamically loads content based on ?course=...&lesson=...

// 1. Define your courses and lessons here:
const courses = {
  "budgeting-101": {
    name: "Budgeting & Saving",
    lessons: [
      { title: "Introduction to Budgeting", description: "What is a budget and why it matters" },
      { title: "Tracking Income and Expenses", description: "How to record your income and spending" },
      { title: "Creating Your First Budget", description: "Step-by-step personal budgeting" },
      { title: "Needs vs. Wants", description: "Differentiating essential vs. discretionary spending" },
      { title: "Emergency Funds", description: "Importance of saving for unexpected expenses" },
      { title: "Setting Financial Goals", description: "Short-term vs. long-term goals" },
      { title: "Reducing Expenses", description: "Strategies to cut costs and optimize spending" },
      { title: "Automating Savings", description: "Using technology to save automatically" },
      { title: "Tracking Progress and Adjusting Budget", description: "Monitoring spending and revising your budget" },
      { title: "Developing a Saving Mindset", description: "Cultivating habits for long-term saving" },
    ]
  },
  "investing-101": {
    name: "Investing 101",
    lessons: [
      { title: "Introduction to Investing", description: "What is investing and why it matters" },
      { title: "Types of Investments", description: "Stocks, bonds, mutual funds, and more" },
      { title: "The Importance of Saving and Compound Interest", description: "Building wealth through time and patience" },
      { title: "Risk and Return", description: "Understanding the risk-reward relationship" },
      { title: "Diversification and Asset Allocation", description: "Building a balanced portfolio" },
      { title: "Mutual Funds and ETFs", description: "Comparing fund types and their benefits" },
      { title: "Stock Market Basics", description: "How stock markets work" },
      { title: "Investment Strategies", description: "Value, growth, and momentum investing" },
      { title: "Analyzing Investments", description: "Fundamental and technical analysis" },
      { title: "Risk Management in Investing", description: "Protecting your portfolio" },
    ]
  }
  // Add new courses here using the same structure!
};

// 2. Utility: Get query parameter from URL
function getQueryParam(name) {
  const params = new URLSearchParams(window.location.search);
  return params.get(name);
}

// 3. Determine active course and lesson
const courseKey = getQueryParam("course") || "budgeting-101";
const course = courses[courseKey] || courses["budgeting-101"];
const lessons = course.lessons;
const lessonCount = lessons.length;
const lessonIndex = Math.max(0, ((parseInt(getQueryParam("lesson"), 10) || 1) - 1));
const currentLesson = lessons[lessonIndex] || lessons[0];

// 4. Populate lesson selector dropdown
const lessonSelect = document.getElementById("lesson-select");
if (lessonSelect) {
  lessonSelect.innerHTML = lessons
    .map((lesson, idx) =>
      `<option value="${idx + 1}" ${idx === lessonIndex ? "selected" : ""}>
        Lesson ${idx + 1}: ${lesson.title}
      </option>`
    ).join("");
  // On change, reload with selected lesson & course
  lessonSelect.addEventListener("change", (e) => {
    window.location.href = `${window.location.pathname}?course=${courseKey}&lesson=${e.target.value}`;
  });
}

// 5. Update breadcrumb with current lesson
const breadcrumb = document.getElementById("lesson-breadcrumb");
if (breadcrumb) {
  breadcrumb.textContent = `Lesson ${lessonIndex + 1}: ${currentLesson.title}`;
}

// 6. Update progress bar
const progressText = document.getElementById("progress-text");
if (progressText) {
  progressText.textContent = `Lesson ${lessonIndex + 1} of ${lessonCount}`;
}
const progressFill = document.getElementById("progress-fill");
if (progressFill) {
  progressFill.style.width = `${((lessonIndex + 1) / lessonCount) * 100}%`;
}

// 7. Render lesson content area (customize as needed!)
const lessonContent = document.getElementById("lesson-content");
if (lessonContent) {
  lessonContent.innerHTML = `
    <h2>${currentLesson.title}</h2>
    <p class="text-muted">${currentLesson.description}</p>
    <p>(Add lesson article, pre-quiz, post-quiz, etc. here...)</p>
  `;
}

// 8. Enable/disable prev/next navigation
const prevBtn = document.getElementById("prev-btn");
if (prevBtn) {
  prevBtn.disabled = lessonIndex === 0;
  prevBtn.onclick = () => {
    if (lessonIndex > 0) {
      window.location.href = `${window.location.pathname}?course=${courseKey}&lesson=${lessonIndex}`;
    }
  };
}
const nextBtn = document.getElementById("next-btn");
if (nextBtn) {
  nextBtn.disabled = lessonIndex === lessonCount - 1;
  nextBtn.onclick = () => {
    if (lessonIndex < lessonCount - 1) {
      window.location.href = `${window.location.pathname}?course=${courseKey}&lesson=${lessonIndex + 2}`;
    }
  };
}

// --- End of Dynamic Lesson Viewer JS ---
